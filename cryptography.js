function isletter(a){
    if(a.charCodeAt(0)>64&&a.charCodeAt(0)<=90)return 1;
    if(a.charCodeAt(0)>96&&a.charCodeAt(0)<=122)return 1;
    return 0;
}
function Pow(a, b, p){
    var ret=1
    for(; b>0; a=a*a%p, b=Math.floor(b/2))if(b%2==1)ret=ret*a%p;
    return ret;
}
var sh=0, a='Crypt0graphy', a0='　'+a+'　', a1='　', b='Use the flag mode you got in Pwnab1e so that it is easier to decode.', m='', shm='';
var M=['-----', '.----', '..---', '...--', '....-', '.....', '-....', '--...', '---..', '----.', '.-', '-...', '-.-.', '-..', '.', '..-.', '--.', '....', '..', '.---', '-.-', '.-..', '--', '-.', '---', '.--.', '--.-', '.-.', '...', '-', '..-', '...-', '.--', '-..-', '-.--', '--..'];
function init(){
    for(var i=0; i<b.length; ++i){
        if(isletter(b[i]))m+=M[parseInt(b[i], 36)]+' ';
    }
    for(var i=0; i<m.length; ++i)shm+=m[i]=='.'?'10':m[i]=='-'?'1110':'00';
    shm+='1111111111000';
}
function shine(){
    if(shm[sh]=='1')document.querySelector('#cryptography').innerHTML=a0;
    else document.querySelector('#cryptography').innerHTML=a1;
    ++sh;
    if(sh==shm.length)sh=0;
}
init();
setInterval(shine, 100);
document.addEventListener('keydown', function(evt){
    if(evt.keyCode==13){
        var item=document.getElementById('flag');
        var t=parseInt(item.value);
        var e=1234365019832743298561032984732985612309847239801750932865091237489237402931847123098471029385632098749832175091823650329874938217463215908732189403265019823748923714980563250918237489237095861230984723562398170973;
        var n=16814514399461412629047112337345835986920507579229333636478669358279850391945185981933576656767016287157047075917085958919781943728142647593236395275681460478747052371740750063433997375736961787513996694181556025592297355066453736357465405673213976399517198024404082402263908010702335141768092750234355464437631896294245979666288832574913585012181821067124009114438262972582325381634975711095297579538728738702367049750893497957;
        var c=745342309554931872468033639963084036796747632299591369982961441515731986620622681306402050073270365011017377102541264017350741070714336528148334875065302090804868287696314012684604714898536797583225191533156497357248080786209694036133990959687677079428062235936504977492519515032210797050486453571532326539977289655464393124631918910865659758892330981239212724685952997509006548847783738597117859789805551392641520182684845356;
        if(Pow(t, e, n)==c)alert('Convert it to ascii.');
    }
});
